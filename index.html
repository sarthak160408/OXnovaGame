<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>OXnova - Smart AI Game</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="container">
    <h1>OXnova - Smart AI Game</h1>
    <p id="turn">Player X's turn</p>
    <div class="score">
      <span>X: <span id="xScore">0</span></span> |
      <span>O: <span id="oScore">0</span></span>
    </div>
    <div class="buttons">
      <button onclick="clearScore()">ðŸ§¹ Clear Score</button>
      <button onclick="toggleSidebar()">â˜° Menu</button>
    </div>
    <div id="sidebar" class="sidebar hidden">
      <h3>Game Mode</h3>
      <button onclick="setMode('ai')">Play with AI</button>
      <button onclick="setMode('multiplayer')">Multiplayer</button>
      <h3>Difficulty</h3>
      <select id="difficulty" onchange="setDifficulty(this.value)">
        <option value="easy">Easy</option>
        <option value="medium">Medium</option>
        <option value="hard">Hard</option>
      </select>
      <button onclick="newGame()">New Game</button>
    </div>
    <div class="board" id="board"></div>
  </div>

  <!-- Ads -->
  <div class="ads">
    <script type="text/javascript">
      atOptions = {
        'key': '2fda4283b018f53f3538c93f5411586d',
        'format': 'iframe',
        'height': 50,
        'width': 320,
        'params': {}
      };
    </script>
    <script type="text/javascript" src="//www.highperformanceformat.com/2fda4283b018f53f3538c93f5411586d/invoke.js"></script>
  </div>

  <script src="script.js"></script>
</body>
</html>
body {
  margin: 0;
  font-family: sans-serif;
  background-color: #2c225d;
  color: white;
  text-align: center;
}
.container {
  padding: 20px;
}
.board {
  display: grid;
  grid-template-columns: repeat(3, 100px);
  grid-gap: 5px;
  justify-content: center;
  margin: 20px auto;
}
.cell {
  width: 100px;
  height: 100px;
  background: white;
  color: black;
  font-size: 2rem;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
}
.buttons button {
  margin: 10px;
  padding: 10px 20px;
  font-size: 16px;
}
.sidebar {
  background: #1e1a3d;
  color: white;
  padding: 10px;
  margin: 10px auto;
  width: 250px;
  border: 1px solid #444;
}
.hidden {
  display: none;
}
.ads {
  margin-top: 30px;
}
let board = [];
let currentPlayer = "X";
let gameMode = "ai";
let difficulty = "easy";
let xScore = 0;
let oScore = 0;

function createBoard() {
  const boardContainer = document.getElementById("board");
  boardContainer.innerHTML = "";
  board = Array(9).fill("");
  for (let i = 0; i < 9; i++) {
    const cell = document.createElement("div");
    cell.className = "cell";
    cell.addEventListener("click", () => makeMove(i));
    boardContainer.appendChild(cell);
  }
  updateTurn();
}

function updateTurn() {
  document.getElementById("turn").innerText = `Player ${currentPlayer}'s turn`;
}

function makeMove(index) {
  if (board[index] !== "") return;
  board[index] = currentPlayer;
  renderBoard();
  if (checkWinner()) return;
  switchPlayer();
  if (gameMode === "ai" && currentPlayer === "O") {
    setTimeout(() => {
      aiMove();
      renderBoard();
      if (!checkWinner()) switchPlayer();
    }, 500);
  }
}

function aiMove() {
  let empty = board.map((v, i) => v === "" ? i : null).filter(v => v !== null);
  let move = empty[Math.floor(Math.random() * empty.length)];
  board[move] = "O";
}

function checkWinner() {
  const winPatterns = [
    [0,1,2],[3,4,5],[6,7,8],
    [0,3,6],[1,4,7],[2,5,8],
    [0,4,8],[2,4,6]
  ];
  for (let [a,b,c] of winPatterns) {
    if (board[a] && board[a] === board[b] && board[a] === board[c]) {
      alert(`${board[a]} wins!`);
      if (board[a] === "X") xScore++; else oScore++;
      updateScores();
      createBoard();
      return true;
    }
  }
  if (!board.includes("")) {
    alert("Draw!");
    createBoard();
    return true;
  }
  return false;
}

function switchPlayer() {
  currentPlayer = currentPlayer === "X" ? "O" : "X";
  updateTurn();
}

function renderBoard() {
  const cells = document.querySelectorAll(".cell");
  cells.forEach((cell, i) => cell.innerText = board[i]);
}

function toggleSidebar() {
  const sidebar = document.getElementById("sidebar");
  sidebar.classList.toggle("hidden");
}

function setMode(mode) {
  gameMode = mode;
  newGame();
}

function setDifficulty(level) {
  difficulty = level;
}

function newGame() {
  currentPlayer = "X";
  createBoard();
}

function clearScore() {
  xScore = 0;
  oScore = 0;
  updateScores();
}

function updateScores() {
  document.getElementById("xScore").innerText = xScore;
  document.getElementById("oScore").innerText = oScore;
}

window.onload = () => {
  createBoard();
};
